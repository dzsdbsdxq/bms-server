/*! 
 Build based on gin-vue-admin 
 Time : 1717039643000 */
!function(){function e(e,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,t(r.key),r)}}function t(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}System.register(["./087AC4D233B64EB0index-legacy.e02f1eb2.js","./087AC4D233B64EB0upload-legacy.c1cf5fb4.js","./087AC4D233B64EB0progress-legacy.09cb36e5.js","./087AC4D233B64EB0button-legacy.6621f510.js"],(function(t,n){"use strict";var i,r,o,a,l,u,s,c,d,f,p;return{setters:[function(e){i=e.K,r=e.r,o=e.o,a=e.c,l=e.d,u=e.w,s=e.i,c=e.t,d=e.E,f=e.k},function(e){p=e.E},null,null],execute:function(){t("g",(function(e){return i({url:"/fileUploadAndDownload/getFileList",method:"post",data:e})})),t("d",(function(e){return i({url:"/fileUploadAndDownload/deleteFile",method:"post",data:e})})),t("e",(function(e){return i({url:"/fileUploadAndDownload/editFileName",method:"post",data:e})}));var n=function(){return t=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1920;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.file=t,this.fileSize=n,this.maxWH=i},(n=[{key:"compress",value:function(){var e=this,t=this.file.type,n=this.file.size/1024;return new Promise((function(i){var r=new FileReader;r.readAsDataURL(e.file),r.onload=function(){var o=document.createElement("canvas"),a=document.createElement("img");a.src=r.result,a.onload=function(){var r=o.getContext("2d"),l=e.dWH(a.width,a.height,e.maxWH);o.width=l.width,o.height=l.height,r.clearRect(0,0,o.width,o.height),r.drawImage(a,0,0,o.width,o.height);var u=o.toDataURL(t,.9),s=e.fileSizeKB(u);s>e.fileSize&&console.log("图片尺寸太大!"+n+" >> "+s);var c=e.dataURLtoBlob(u,t),d=new File([c],e.file.name);i(d)}}}))}},{key:"dWH",value:function(e,t,n){var i={width:e,height:t};return Math.max(e,t)>n?e>t?(i.width=n,i.height=Math.round(t*(n/e)),i):(i.height=n,i.width=Math.round(e*(n/t)),i):i}},{key:"fileSizeKB",value:function(e){return Math.round(3*e.split(",")[1].length/4/1024)}},{key:"dataURLtoBlob",value:function(e,t){for(var n=atob(e.split(",")[1]),i=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(n.length),o=new Uint8Array(r),a=0;a<n.length;a++)o[a]=n.charCodeAt(a);return t&&(i=t),new Blob([r],{type:i,lastModifiedDate:new Date})}}])&&e(t.prototype,n),i&&e(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,i}();t("I",n);t("a",(function(e){return e&&"http"!==e.slice(0,4)?"https://www.sztv.com.cn/ysztv/web//"+e:e})),t("i",(function(e){return e.endsWith(".mp4")||e.endsWith(".mov")||e.endsWith(".webm")||e.endsWith(".ogg")})),t("_",Object.assign({name:"UploadCommon"},{__name:"common",props:{textTag:{type:String,default:"腾讯COS上传"},btnType:{type:String,default:"primary"},engine:{type:String,default:""}},emits:["on-success"],setup:function(e,t){var n=t.emit,i=r("https://www.sztv.com.cn/ysztv/web/"),h=r(!1),g=function(e){h.value=!0;var t,n=e.size/1024/1024<15,i=e.size/1024/1024<15,r="video/mp4"===(t=e.type)||"video/webm"===t||"video/ogg"===t,o=function(e){return"image/jpeg"===e||"image/png"===e||"image/webp"===e||"image/svg+xml"===e}(e.type),a=!0;return r||o||(d.error("上传图片只能是 jpg,png,svg,webp 格式, 上传视频只能是 mp4,webm 格式!"),h.value=!1,a=!1),!i&&r&&(d.error("上传视频大小不能超过 15MB"),h.value=!1,a=!1),!n&&o&&(d.error("未压缩的上传图片大小不能超过 500KB，请使用压缩上传"),h.value=!1,a=!1),console.log("upload file check result: ",a),a},m=function(e){var t=e.data;t.file&&n("on-success",t.file.url)},v=function(){d({type:"error",message:"上传失败"}),h.value=!1};return function(t,n){var r=f,d=p;return o(),a("div",null,[l(d,{action:"".concat(i.value,"/fileUploadAndDownload/upload?engine=").concat(e.engine),"before-upload":g,"on-error":v,"on-success":m,"show-file-list":!1,class:"upload-btn"},{default:u((function(){return[l(r,{size:"small",type:e.btnType},{default:u((function(){return[s(c(e.textTag),1)]})),_:1},8,["type"])]})),_:1},8,["action"])])}}}))}}}))}();
