/*! 
 Build based on gin-vue-admin 
 Time : 1717039643000 */
import{o as e,g as a,w as l,i as t,E as o,k as s,d as i,_ as r,r as n,c as p,b as u,F as d,m as c,t as m,P as v,j as f}from"./087AC4D233B64EB0index.39f1eb31.js";import{E as g}from"./087AC4D233B64EB0drawer.ae3d541f.js";import"./087AC4D233B64EB0overlay.3905897c.js";import{E as B}from"./087AC4D233B64EB0pagination.ce43b352.js";/* empty css                              */import"./087AC4D233B64EB0tag.d3c1c3e4.js";import{E as b,a as y}from"./087AC4D233B64EB0select.7f5b5538.js";import"./087AC4D233B64EB0scrollbar.3894915f.js";/* empty css                               */import{E as h,a as C}from"./087AC4D233B64EB0table-column.e9b4a870.js";import"./087AC4D233B64EB0checkbox.a3853383.js";/* empty css                                */import{a as w,E}from"./087AC4D233B64EB0form-item.a86c41d2.js";/* empty css                               */import{g as _,d as A,f as D,a as j,u as x,c as z,b as k}from"./087AC4D233B64EB0api.db29bd05.js";import{t as I}from"./087AC4D233B64EB0stringFun.24b05cf5.js";import{_ as V}from"./087AC4D233B64EB0warningBar.beb718a3.js";import{E as T}from"./087AC4D233B64EB0upload.099811f5.js";import"./087AC4D233B64EB0progress.65ec04e5.js";import"./087AC4D233B64EB0isUndefined.d281c39a.js";import"./087AC4D233B64EB0isEqual.e024b3a6.js";import"./087AC4D233B64EB0_Uint8Array.02b83471.js";import"./087AC4D233B64EB0hasIn.9f12b2a1.js";import"./087AC4D233B64EB0index.d8bfc0de.js";import"./087AC4D233B64EB0index.5d58b83c.js";import"./087AC4D233B64EB0strings.2df7e9e1.js";import"./087AC4D233B64EB0debounce.0aab18a9.js";import"./087AC4D233B64EB0_initCloneObject.0c0ca3ea.js";import"./087AC4D233B64EB0castArray.209ac14b.js";import"./087AC4D233B64EB0_baseClone.a73122b0.js";import"./087AC4D233B64EB0cloneDeep.5b0b6a51.js";const S={__name:"exportExcel",props:{templateId:{type:String,required:!0},condition:{type:Object,default:()=>({})},limit:{type:Number,default:0},offset:{type:Number,default:0},order:{type:String,default:""}},setup(i){const r=i,n=async()=>{if(""===r.templateId)return void o.error("组件未设置模板ID");const e=JSON.parse(JSON.stringify(r.condition));r.limit&&(e.limit=r.limit),r.offset&&(e.offset=r.offset),r.order&&(e.order=r.order);const a=Object.entries(e).map((([e,a])=>"".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(a)))).join("&"),l="".concat("https://www.sztv.com.cn/ysztv/web/","/sysExportTemplate/exportExcel?templateID=").concat(r.templateId).concat(a?"&"+a:"");window.open(l,"_blank")};return(o,i)=>{const r=s;return e(),a(r,{type:"primary",icon:"download",size:"small",onClick:n},{default:l((()=>[t("导出")])),_:1})}}},U={__name:"exportTemplate",props:{templateId:{type:String,required:!0}},setup(i){const r=i,n=async()=>{if(""===r.templateId)return void o.error("组件未设置模板ID");const e="".concat("https://www.sztv.com.cn/ysztv/web/","/sysExportTemplate/exportTemplate?templateID=").concat(r.templateId);window.open(e,"_blank")};return(o,i)=>{const r=s;return e(),a(r,{type:"primary",icon:"download",size:"small",onClick:n},{default:l((()=>[t("下载模板")])),_:1})}}},G={__name:"importExcel",props:{templateId:{type:String,required:!0}},emits:["on-success"],setup(r,{emit:n}){const p=r,u=n,d="".concat("https://www.sztv.com.cn/ysztv/web/","/sysExportTemplate/importExcel?templateID=").concat(p.templateId),c=e=>{0===e.code?(o.success("导入成功"),u("on-success")):o.error(e.msg)};return(o,r)=>{const n=s,p=T;return e(),a(p,{action:d,"show-file-list":!1,"on-success":c,multiple:!1},{default:l((()=>[i(n,{type:"primary",size:"small",icon:"upload"},{default:l((()=>[t("导入")])),_:1})])),_:1})}}},q={class:"gva-search-box"},O={class:"gva-table-box"},P={class:"gva-btn-list"},F={class:"gva-pagination"},N={class:"flex items-center justify-between"},R={class:"text-lg"},J=r(Object.assign({name:"Api"},{__name:"api",setup(r){const T=e=>{const a=L.value.filter((a=>a.value===e))[0];return a&&"".concat(a.label)},J=n([]),K=n({path:"",apiGroup:"",method:"",description:""}),L=n([{value:"POST",label:"创建",type:"success"},{value:"GET",label:"查看",type:""},{value:"PUT",label:"更新",type:"warning"},{value:"DELETE",label:"删除",type:"danger"}]),$=n(""),H=n({path:[{required:!0,message:"请输入api路径",trigger:"blur"}],apiGroup:[{required:!0,message:"请输入组名称",trigger:"blur"}],method:[{required:!0,message:"请选择请求方式",trigger:"blur"}],description:[{required:!0,message:"请输入api介绍",trigger:"blur"}]}),M=n(1),Q=n(0),W=n(10),X=n([]),Y=n({}),Z=()=>{Y.value={}},ee=()=>{M.value=1,W.value=10,oe()},ae=e=>{W.value=e,oe()},le=e=>{M.value=e,oe()},te=({prop:e,order:a})=>{e&&("ID"===e&&(e="id"),Y.value.orderKey=I(e),Y.value.desc="descending"===a),oe()},oe=async()=>{const e=await _({page:M.value,pageSize:W.value,...Y.value});0===e.code&&(X.value=e.data.list,Q.value=e.data.total,M.value=e.data.page,W.value=e.data.pageSize)};oe();const se=e=>{J.value=e},ie=async()=>{v.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const e=J.value.map((e=>e.ID)),a=await A({ids:e});0===a.code&&(o({type:"success",message:a.msg}),X.value.length===e.length&&M.value>1&&M.value--,oe())}))},re=async()=>{v.confirm("确定要刷新缓存吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const e=await D();0===e.code&&o({type:"success",message:e.msg})}))},ne=n(null),pe=n("新增Api"),ue=n(!1),de=e=>{switch(e){case"addApi":pe.value="新增Api";break;case"edit":pe.value="编辑Api"}$.value=e,ue.value=!0},ce=()=>{ne.value.resetFields(),K.value={path:"",apiGroup:"",method:"",description:""},ue.value=!1},me=async()=>{ne.value.validate((async e=>{if(e)switch($.value){case"addApi":0===(await z(K.value)).code&&o({type:"success",message:"添加成功",showClose:!0}),oe(),ce();break;case"edit":0===(await x(K.value)).code&&o({type:"success",message:"编辑成功",showClose:!0}),oe(),ce();break;default:o({type:"error",message:"未知操作",showClose:!0})}}))};return(r,n)=>{const _=f,A=w,D=b,x=y,z=s,I=E,$=h,ve=C,fe=B,ge=g;return e(),p("div",null,[u("div",q,[i(I,{ref:"searchForm",inline:!0,model:Y.value},{default:l((()=>[i(A,{label:"路径"},{default:l((()=>[i(_,{modelValue:Y.value.path,"onUpdate:modelValue":n[0]||(n[0]=e=>Y.value.path=e),size:"small",placeholder:"路径"},null,8,["modelValue"])])),_:1}),i(A,{label:"API组"},{default:l((()=>[i(_,{modelValue:Y.value.apiGroup,"onUpdate:modelValue":n[1]||(n[1]=e=>Y.value.apiGroup=e),size:"small",placeholder:"api组"},null,8,["modelValue"])])),_:1}),i(A,{label:"请求"},{default:l((()=>[i(x,{modelValue:Y.value.method,"onUpdate:modelValue":n[2]||(n[2]=e=>Y.value.method=e),size:"small",clearable:"",placeholder:"请选择"},{default:l((()=>[(e(!0),p(d,null,c(L.value,(l=>(e(),a(D,{key:l.value,label:"".concat(l.label,"(").concat(l.value,")"),value:l.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),i(A,null,{default:l((()=>[i(z,{type:"primary",icon:"search",size:"small",onClick:ee},{default:l((()=>[t("查询")])),_:1}),i(z,{icon:"refresh",size:"small",onClick:Z},{default:l((()=>[t("重置")])),_:1})])),_:1})])),_:1},8,["model"])]),u("div",O,[u("div",P,[i(z,{type:"primary",icon:"plus",size:"small",onClick:n[3]||(n[3]=e=>de("addApi"))},{default:l((()=>[t("新增")])),_:1}),i(z,{icon:"delete",size:"small",disabled:!J.value.length,onClick:ie},{default:l((()=>[t("删除")])),_:1},8,["disabled"]),i(z,{icon:"Refresh",size:"small",onClick:re},{default:l((()=>[t("刷新缓存")])),_:1}),i(U,{"template-id":"api"}),i(S,{"template-id":"api",limit:9999}),i(G,{"template-id":"api",onOnSuccess:oe})]),i(ve,{data:X.value,onSortChange:te,onSelectionChange:se},{default:l((()=>[i($,{type:"selection",width:"55"}),i($,{align:"left",label:"id","min-width":"60",prop:"ID",sortable:"custom"}),i($,{align:"left",label:"API路径","min-width":"250",prop:"path",sortable:"custom"}),i($,{align:"left",label:"API分组","min-width":"100",prop:"apiGroup",sortable:"custom"}),i($,{align:"left",label:"API简介","min-width":"150",prop:"description",sortable:"custom"}),i($,{align:"left",label:"请求","min-width":"100",prop:"method",sortable:"custom"},{default:l((e=>[u("div",null,m(e.row.method)+" / "+m(T(e.row.method)),1)])),_:1}),i($,{align:"left",fixed:"right",label:"操作",width:"200"},{default:l((e=>[i(z,{icon:"edit",size:"small",type:"primary",link:"",onClick:a=>(async e=>{const a=await j({id:e.ID});K.value=a.data.api,de("edit")})(e.row)},{default:l((()=>[t("编辑")])),_:2},1032,["onClick"]),i(z,{icon:"delete",size:"small",type:"primary",link:"",onClick:a=>(async e=>{v.confirm("此操作将永久删除所有角色下该api, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{0===(await k(e)).code&&(o({type:"success",message:"删除成功!"}),1===X.value.length&&M.value>1&&M.value--,oe())}))})(e.row)},{default:l((()=>[t("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),u("div",F,[i(fe,{"current-page":M.value,"page-size":W.value,small:"","page-sizes":[10,30,50,100],total:Q.value,layout:"total, sizes, prev, pager, next",onCurrentChange:le,onSizeChange:ae},null,8,["current-page","page-size","total"])])]),i(ge,{modelValue:ue.value,"onUpdate:modelValue":n[8]||(n[8]=e=>ue.value=e),size:"60%","before-close":ce,"show-close":!1},{header:l((()=>[u("div",N,[u("span",R,m(pe.value),1),u("div",null,[i(z,{size:"small",onClick:ce},{default:l((()=>[t("取 消")])),_:1}),i(z,{size:"small",type:"primary",onClick:me},{default:l((()=>[t("确 定")])),_:1})])])])),default:l((()=>[i(V,{title:"新增API，需要在角色管理内配置权限才可使用"}),i(I,{ref_key:"apiForm",ref:ne,model:K.value,rules:H.value,"label-width":"80px"},{default:l((()=>[i(A,{label:"路径",prop:"path"},{default:l((()=>[i(_,{modelValue:K.value.path,"onUpdate:modelValue":n[4]||(n[4]=e=>K.value.path=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),i(A,{label:"请求",prop:"method"},{default:l((()=>[i(x,{modelValue:K.value.method,"onUpdate:modelValue":n[5]||(n[5]=e=>K.value.method=e),placeholder:"请选择",style:{width:"100%"}},{default:l((()=>[(e(!0),p(d,null,c(L.value,(l=>(e(),a(D,{key:l.value,label:"".concat(l.label,"(").concat(l.value,")"),value:l.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),i(A,{label:"api分组",prop:"apiGroup"},{default:l((()=>[i(_,{modelValue:K.value.apiGroup,"onUpdate:modelValue":n[6]||(n[6]=e=>K.value.apiGroup=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),i(A,{label:"api简介",prop:"description"},{default:l((()=>[i(_,{modelValue:K.value.description,"onUpdate:modelValue":n[7]||(n[7]=e=>K.value.description=e),autocomplete:"off"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-c0a70bbe"]]);export{J as default};
